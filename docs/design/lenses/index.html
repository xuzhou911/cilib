<!DOCTYPE html>
<html lang="en" data-theme="">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">

<script type="text/javascript">/*<![CDATA[*/window.__chunkMapping={"17896441":["/17896441.29431441.js"],"99962420":["/99962420.db3820cf.js"],"main":["/main.7176ed0c.js"],"01a85c17":["/01a85c17.002c6c49.js"],"04e704ea":["/04e704ea.d1f14f2c.js"],"078b9a12":["/078b9a12.8a05a974.js"],"0db74fd8":["/0db74fd8.37dc4122.js"],"173a51a4":["/173a51a4.310cc8c8.js"],"19a7a85c":["/19a7a85c.35f84886.js"],"1adc757d":["/1adc757d.3509cb45.js"],"1b10eddc":["/1b10eddc.5d1db444.js"],"1be78505":["/1be78505.0bdbca75.js"],"1d72c118":["/1d72c118.5aaca433.js"],"20ac7829":["/20ac7829.88f0a7de.js"],"23d0d5e6":["/23d0d5e6.f59781b3.js"],"2868cdab":["/2868cdab.733d49c4.js"],"30c5a7f3":["/30c5a7f3.bc354599.js"],"31d49d87":["/31d49d87.7da96289.js"],"3570154c":["/3570154c.af6e25ba.js"],"3a6eb64e":["/3a6eb64e.1039e5fe.js"],"46bad1bb":["/46bad1bb.08359660.js"],"4b2ec4d2":["/4b2ec4d2.c2093f6c.js"],"616665f6":["/616665f6.d0547c14.js"],"6357db08":["/6357db08.88aa6a76.js"],"6875c492":["/6875c492.d28de3d7.js"],"6ca375e2":["/6ca375e2.4ebef808.js"],"6d1c13a3":["/6d1c13a3.be8e37f3.js"],"6f0da4be":["/6f0da4be.ad4d4fc0.js"],"73cb3229":["/73cb3229.dc543418.js"],"80e54ec0":["/80e54ec0.eb2c7267.js"],"8be5b89e":["/8be5b89e.22a5054f.js"],"8e9f0a8a":["/8e9f0a8a.e784e5d5.js"],"9d446eb3":["/9d446eb3.28a1b59d.js"],"9ea0a9c8":["/9ea0a9c8.b591015b.js"],"9f18abe7":["/9f18abe7.16ca3927.js"],"a09c2993":["/a09c2993.aa110678.js"],"a56d56f0":["/a56d56f0.614cafc2.js"],"a610a6a7":["/a610a6a7.5d3a9744.js"],"a6aa9e1f":["/a6aa9e1f.04825ae7.js"],"af172acd":["/af172acd.e6954db1.js"],"b27df9a5":["/b27df9a5.62f9ca9c.js"],"b2f90839":["/b2f90839.6b1fabd5.js"],"bbb4ffb5":["/bbb4ffb5.43d54e9b.js"],"bdd709f1":["/bdd709f1.5c69534c.js"],"be6abd5f":["/be6abd5f.cd305bad.js"],"c2fcacf2":["/c2fcacf2.4e402cf4.js"],"c4f5d8e4":["/c4f5d8e4.659e1fb6.js"],"c626e739":["/c626e739.85425670.js"],"ccc49370":["/ccc49370.09391ba5.js"],"ce3e42ad":["/ce3e42ad.01785220.js"],"cf90a153":["/cf90a153.49b6fac4.js"],"d3f22c97":["/d3f22c97.d9bb54f1.js"],"d4f12710":["/d4f12710.667265f3.js"],"d5b8efef":["/d5b8efef.1d7570a6.js"],"d610846f":["/d610846f.6e6efbed.js"],"db37d046":["/db37d046.0c31a8e1.js"],"dc4d9aa3":["/dc4d9aa3.ca917ebe.js"],"df361e2b":["/df361e2b.b9c857c1.js"],"ed2e92c0":["/ed2e92c0.d0342714.js"],"eec15bdb":["/eec15bdb.489bb882.js"]};/*]]>*/</script>

<title data-react-helmet="true">lenses</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" property="og:title" content="CIlib · Predictable and Pure Evolutionary and Swarm Intelligence"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="description" content="# Immutable data"/><meta data-react-helmet="true" property="og:description" content="# Immutable data"/><meta data-react-helmet="true" property="og:url" content="https://cilib.net/docs/design/lenses"/>

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"/>


<link rel="stylesheet" type="text/css" href="/styles.2cd98a7d.css" />

</head>
<body >
<script type="text/javascript">(function() {
  function setDataThemeAttribute(theme) {
    document.querySelector('html').setAttribute('data-theme', theme);
  }
  
  var preferDarkQuery = '(prefers-color-scheme: dark)';
  var mql = window.matchMedia(preferDarkQuery);
  var supportsColorSchemeQuery = mql.media === preferDarkQuery;
  var localStorageTheme = null;
  try {
    localStorageTheme = localStorage.getItem('theme');
  } catch (err) {}
  var localStorageExists = localStorageTheme !== null;

  if (localStorageExists) {
    setDataThemeAttribute(localStorageTheme);
  } else if (supportsColorSchemeQuery && mql.matches) {
    setDataThemeAttribute('dark');
  }
})();</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo"/><strong class="">CIlib</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/ciren/cilib">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"/></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo"/><strong>CIlib</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/ciren/cilib">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">lenses</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="immutable-data"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#immutable-data" title="Direct link to heading">#</a>Immutable data</h1><p>Immutable data is fantastic because it allows anyone to read the contents
of the data and provides the security that the data will not change. In some
cases, however, we would like to &quot;change&quot; some data value. Using immutable
data means that we cannot change the value within a structure, instead we
need to create an updated view of the data with the changes applied. This
updated view creates new data, where the old data is still present and
unchanged. It&#x27;s recommended that the reader become familiar with
persistent data structures and how they operate. Due to how persistent
data structures update, by only changing the smallest number of references,
the needed speed and efficiency is achieved.</p><p>Scala tries to help with respect to immutable data, by providing a convenience
method on all <code>case class</code>es called <code>copy</code>. In situations where there is a
nesting of case classes, potentially several levels, the updating of a value
on the lower levels results in a bubbling-up process whereby each previous
layer needs to update the reference to the new data in the lower layer.
Although this is not difficult to do, the result is very verbose and
extremely cumbersome for the user. It would be nice if this &quot;zooming&quot;
update process was abstracted behind a data structure that would hide and
automate the tedious process.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="lenses"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#lenses" title="Direct link to heading">#</a>Lenses</h1><p>A <code>Lens</code> can, in the most trivial of ways, be seen as a simple getter
and setter function pair. Within CIlib, several common lenses are available
in order to extract information from the state of the <code>Entity</code>, or
anything else for which a <code>Lens</code> has been defined. Because lenses
allow the user to &quot;zoom&quot; onto data, potentially nested under many levels
in another data structure, they are convenient as they allow for correctly
updating the &quot;zoomed&quot; location in addition to extracting the value.</p><p>Trying to not re-invent the wheel, the
<a href="http://julien-truffaut.github.io/Monocle/%3E">Monocle</a> library
provides the lens functionality. Lenses are structures that can also be
composed together and are collectively called &quot;optics&quot;. Please refer to
Monocle&#x27;s documentation to learn more about lenses and optics. CIlib
specific lens questions can be directed to the CIlib gitter room or IRC.</p><p>Lenses provide an API that is first and foremost, composition and lawful.
This means that the various optics are well behaved and rules exist that
govern their usage. Furthermore, different optics may be composed together
to create new optics that are the combination of the original optics. This
is obviously only possible if the provided types correctly line up.</p><p>Building on the usage of optics in general, we use a mechanism known as
&quot;classy lens&quot; in Haskell. This mechanism prevents invalid usage, by letting
the compiler fail based on the types being used. In the case of <code>Entity</code>,
the compiler would look up instances, using it&#x27;s implicit resolution rules,
to obtain evidence for a typeclass with a given set of types, at compile time.</p><p>This provides an additional level of surety, that the data being passed to
a function that requires evidence in order to extract some other piece of
information for a given type. The scala compiler provides the evidence
through the use of its implicit lookup mechanics.
This may seem quite like a mouthful, but let&#x27;s have a look a few examples
that will hopefully make the usage clearer.</p><p>Based on the normally accepted usage of &quot;classy lenses&quot;, the typeclasses
that expose the lenses are generally prefixed with <code>Has</code>. An example of
this would be the <code>HasMemory</code> typeclass. The typeclass definition is simply:</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_3ZcX"><pre class="prism-code language-undefined codeBlock_1wn8" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">trait HasMemory[S,A] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def _memory: Lens[S, Position[A]]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></pre><p><code>HasMemory</code> defines a lens member, with the name <code>_memory</code> that can from
a given <code>S</code> provide a <code>Position[A]</code>. There is absolutely no mention of
what <code>S</code> is, or should be, but the typeclass allows for a set of instances
that can actually provide this result. Within the context of the GA, Individuals
are entities that <em>do not</em> maintain a memory; whereas within the PSO, Particles
do maintain a memory of their previous best position (where <code>Position[A]</code> is
a candidate solution of the problem space). The base module within the library
already provides several optics for the user that operate on <code>Position[A]</code>
instances, allowing for the extraction of the candidate solution, the fitness
and the constraint violations. Other optics for other structures are also available.</p><p>The usage of these classy lenses will become even clearer when we look into what
the generalization of Individual and Particle, the <em>Entity</em>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/doc1">Docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://discordapp.com/invite/docusaurus">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="text--center">Copyright © 2019 Facebook, Inc. Built with Docusaurus.</div></div></footer>
</div>

<script type="text/javascript" src="/styles.0645b5bd.js"></script>

<script type="text/javascript" src="/runtime~main.40f94254.js"></script>

<script type="text/javascript" src="/main.7176ed0c.js"></script>

<script type="text/javascript" src="/1.6551279e.js"></script>

<script type="text/javascript" src="/2.cb9bf06e.js"></script>

<script type="text/javascript" src="/1be78505.0bdbca75.js"></script>

<script type="text/javascript" src="/20ac7829.88f0a7de.js"></script>

<script type="text/javascript" src="/17896441.29431441.js"></script>

<script type="text/javascript" src="/19a7a85c.35f84886.js"></script>


</body>
</html>